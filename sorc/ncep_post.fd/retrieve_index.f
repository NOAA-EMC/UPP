!> @file
!                .      .    .                                       .
!> subprogram:    retrieve_index  get record number of desired variable
!!   prgmmr: parrish          org: np22                date: 2004-11-29
!!
!! abstract: by examining previously generated inventory of wrf binary restart file,
!!             find record number that contains the header record for variable
!!             identified by input character variable "string".
!!
!! program history log:
!!   2004-11-29  parrish
!!
!!   input argument list:
!!     string           - mnemonic for variable desired
!!     varname_all      - list of all mnemonics obtained from inventory of file
!!     nrecs            - total number of sequential records counted in wrf
!!                        binary restart file
!!
!!   output argument list:
!!     index            - desired record number
!!     iret             - return status, set to 0 if variable was found,
!!                        non-zero if not.
!!
!! attributes:
!!   language: f90
!!   machine:  ibm RS/6000 SP
!!
!!
      subroutine retrieve_index(index,string,varname_all,nrecs,iret)


  implicit none

  integer,intent(out)::iret
  integer,intent(in)::nrecs
  integer,intent(out):: index
  character(*), intent(in):: string
  character(132),intent(in)::varname_all(nrecs)

  integer i

  iret=0

  do i=1,nrecs
   if(trim(string) == trim(varname_all(i))) then
      index=i
      return
   end if
  end do

  write(6,*)' problem reading wrf nmm binary file, rec id "',trim(string),'" not found'

  iret=-1

end subroutine retrieve_index

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UPP: UPP_PHYSICS.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">UPP<span id="projectnumber">&#160;(upp-srw-2.2.0)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('UPP__PHYSICS_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">UPP_PHYSICS.f File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>upp_physics is a collection of UPP subroutines for physics variables calculation.  
<a href="#details">More...</a></p>

<p><a href="UPP__PHYSICS_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a46c408fd0419f6dfd0214a4a6d0f606c" id="r_a46c408fd0419f6dfd0214a4a6d0f606c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a46c408fd0419f6dfd0214a4a6d0f606c">upp_physics::calcape</a> (itype, dpbnd, p1d, t1d, q1d, l1d, cape, cins, pparc, zeql, thund)</td></tr>
<tr class="memdesc:a46c408fd0419f6dfd0214a4a6d0f606c"><td class="mdescLeft">&#160;</td><td class="mdescRight">calcape() computes CAPE and CINS.  <br /></td></tr>
<tr class="separator:a46c408fd0419f6dfd0214a4a6d0f606c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13b72d00c41c6c1a7dfca7aa9d3266e1" id="r_a13b72d00c41c6c1a7dfca7aa9d3266e1"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a13b72d00c41c6c1a7dfca7aa9d3266e1">upp_physics::calcape2</a> (itype, dpbnd, p1d, t1d, q1d, l1d, cape, cins, lfc, esrhl, esrhh, dcape, dgld, esp)</td></tr>
<tr class="memdesc:a13b72d00c41c6c1a7dfca7aa9d3266e1"><td class="mdescLeft">&#160;</td><td class="mdescRight">calcape2() computes CAPE and CINS.  <br /></td></tr>
<tr class="separator:a13b72d00c41c6c1a7dfca7aa9d3266e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97b2aa2b11c2ddd32a3999840dbd15ab" id="r_a97b2aa2b11c2ddd32a3999840dbd15ab"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a97b2aa2b11c2ddd32a3999840dbd15ab">upp_physics::caldiv</a> (uwnd, vwnd, div)</td></tr>
<tr class="memdesc:a97b2aa2b11c2ddd32a3999840dbd15ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">CALDIV computes divergence.  <br /></td></tr>
<tr class="separator:a97b2aa2b11c2ddd32a3999840dbd15ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a671b132cb3bffbe08d56c7b7c2a8ef33" id="r_a671b132cb3bffbe08d56c7b7c2a8ef33"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a671b132cb3bffbe08d56c7b7c2a8ef33">upp_physics::calgradps</a> (ps, psx, psy)</td></tr>
<tr class="memdesc:a671b132cb3bffbe08d56c7b7c2a8ef33"><td class="mdescLeft">&#160;</td><td class="mdescRight">CALGRADPS computes gardients of a scalar field PS or LNPS.  <br /></td></tr>
<tr class="separator:a671b132cb3bffbe08d56c7b7c2a8ef33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e8141fa69fd4bd9ee1207346f2c69c8" id="r_a6e8141fa69fd4bd9ee1207346f2c69c8"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a6e8141fa69fd4bd9ee1207346f2c69c8">upp_physics::calrh</a> (p1, t1, q1, rh)</td></tr>
<tr class="memdesc:a6e8141fa69fd4bd9ee1207346f2c69c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">CALRH() computes relative humidity.  <br /></td></tr>
<tr class="separator:a6e8141fa69fd4bd9ee1207346f2c69c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf9004bc64fdc4edc54e3e0e564e60de" id="r_adf9004bc64fdc4edc54e3e0e564e60de"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#adf9004bc64fdc4edc54e3e0e564e60de">upp_physics::calrh_gfs</a> (p1, t1, q1, rh)</td></tr>
<tr class="memdesc:adf9004bc64fdc4edc54e3e0e564e60de"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="UPP__PHYSICS_8f.html#adf9004bc64fdc4edc54e3e0e564e60de" title="calrh_gfs() computes relative humidity.">calrh_gfs()</a> computes relative humidity.  <br /></td></tr>
<tr class="separator:adf9004bc64fdc4edc54e3e0e564e60de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9879351bf693bdbc79b08c01357f5c35" id="r_a9879351bf693bdbc79b08c01357f5c35"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a9879351bf693bdbc79b08c01357f5c35">upp_physics::calrh_gsd</a> (p1, t1, q1, rhb)</td></tr>
<tr class="memdesc:a9879351bf693bdbc79b08c01357f5c35"><td class="mdescLeft">&#160;</td><td class="mdescRight">CALRH_GSD() Compute RH with the NOAA GSL (formerly NOAA GSD) algorithm used for RUC and Rapid Refresh.  <br /></td></tr>
<tr class="separator:a9879351bf693bdbc79b08c01357f5c35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d369564cb2455aebb6623b64093eaf8" id="r_a8d369564cb2455aebb6623b64093eaf8"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a8d369564cb2455aebb6623b64093eaf8">upp_physics::calrh_nam</a> (p1, t1, q1, rh)</td></tr>
<tr class="memdesc:a8d369564cb2455aebb6623b64093eaf8"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="UPP__PHYSICS_8f.html#a8d369564cb2455aebb6623b64093eaf8" title="calrh_nam() computes relative humidity.">calrh_nam()</a> computes relative humidity.  <br /></td></tr>
<tr class="separator:a8d369564cb2455aebb6623b64093eaf8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcd50827e614553e34e5150b7dc2d0d2" id="r_adcd50827e614553e34e5150b7dc2d0d2"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#adcd50827e614553e34e5150b7dc2d0d2">upp_physics::calrh_pw</a> (rhpw)</td></tr>
<tr class="memdesc:adcd50827e614553e34e5150b7dc2d0d2"><td class="mdescLeft">&#160;</td><td class="mdescRight">CALRH_PW() algorithm used at GSL for RUC and Rapid Refresh.  <br /></td></tr>
<tr class="separator:adcd50827e614553e34e5150b7dc2d0d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ed3521072e06748ebed2a1d549cef76" id="r_a7ed3521072e06748ebed2a1d549cef76"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a7ed3521072e06748ebed2a1d549cef76">upp_physics::calslr_roebber</a> (tprs, rhprs, slr)</td></tr>
<tr class="memdesc:a7ed3521072e06748ebed2a1d549cef76"><td class="mdescLeft">&#160;</td><td class="mdescRight">calslr_roebber() computes snow solid-liquid-ratio slr using the Roebber algorithm.  <br /></td></tr>
<tr class="separator:a7ed3521072e06748ebed2a1d549cef76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8aeb7fd8cea2061bb31097413ed0a6cf" id="r_a8aeb7fd8cea2061bb31097413ed0a6cf"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a8aeb7fd8cea2061bb31097413ed0a6cf">upp_physics::calslr_uutah</a> (slr)</td></tr>
<tr class="memdesc:a8aeb7fd8cea2061bb31097413ed0a6cf"><td class="mdescLeft">&#160;</td><td class="mdescRight">calslr_uutah() computes snow solid-liquid-ratio slr using the Steenburgh algorithm.  <br /></td></tr>
<tr class="separator:a8aeb7fd8cea2061bb31097413ed0a6cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a174a9a297a3644adc9f67cd06fa1a208" id="r_a174a9a297a3644adc9f67cd06fa1a208"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a174a9a297a3644adc9f67cd06fa1a208">upp_physics::calvor</a> (uwnd, vwnd, absv)</td></tr>
<tr class="memdesc:a174a9a297a3644adc9f67cd06fa1a208"><td class="mdescLeft">&#160;</td><td class="mdescRight">CALVOR() computes absolute vorticity.  <br /></td></tr>
<tr class="separator:a174a9a297a3644adc9f67cd06fa1a208"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0e747563558603cdbebb4e81e131e1b" id="r_aa0e747563558603cdbebb4e81e131e1b"><td class="memItemLeft" align="right" valign="top">elemental real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#aa0e747563558603cdbebb4e81e131e1b">upp_physics::fpvsnew</a> (t)</td></tr>
<tr class="separator:aa0e747563558603cdbebb4e81e131e1b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70b48ea26577bce987cd88664ce6f10e" id="r_a70b48ea26577bce987cd88664ce6f10e"><td class="memItemLeft" align="right" valign="top">elemental real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="UPP__PHYSICS_8f.html#a70b48ea26577bce987cd88664ce6f10e">upp_physics::tvirtual</a> (t, q)</td></tr>
<tr class="separator:a70b48ea26577bce987cd88664ce6f10e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>upp_physics is a collection of UPP subroutines for physics variables calculation. </p>
<dl class="section author"><dt>Author</dt><dd>Jesse Meng </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-05-20</dd></dl>
<p>calcape() computes CAPE/CINS and other storm related variables.</p>
<p>calcape2() computes additional storm related variables.</p>
<p>caldiv() computes divergence.</p>
<p>calgradps() computes gardients of a scalar field PS or LNPS.</p>
<p>calrh(), calrh_nam(), calrh_gfs(), calrh_gsd() compute RH using various algorithms.</p>
<p>The NAM v4.1.18 algorithm (calrh_nam()) is selected as default for NMMB and FV3GFS, FV3GEFS, and FV3R for the UPP 2020 unification.</p>
<p>calrh_pw() algorithm use at GSD for RUC and Rapid Refresh.</p>
<p>calslr_roebber() computes snow solid-liquid-ratio slr using the Roebber algorithm.</p>
<p>calslr_uutah() computes snow solid-liquid-ratio slr using the UUtah Steenburgh algorithm.</p>
<p>calvor() computes absolute vorticity. <br  />
</p>
<p>fpvsnew() computes saturation vapor pressure.</p>
<p>tvirtual() computes virtual temperature.</p>
<h3><a class="anchor" id="autotoc_md89"></a>
Program history log:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2020-05-20   </td><td class="markdownTableBodyNone">Jesse Meng   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2022-07-11   </td><td class="markdownTableBodyNone">Jesse Meng   </td><td class="markdownTableBodyNone">CALSLR_ROEBBER    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2023-02-14   </td><td class="markdownTableBodyNone">Jesse Meng   </td><td class="markdownTableBodyNone">CALSLR_UUTAH    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2023-03-22   </td><td class="markdownTableBodyNone">Sam Trahan   </td><td class="markdownTableBodyNone">Fix out-of-bounds access by not calling BOUND   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Jesse Meng </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2020-05-20 </dd></dl>

<p class="definition">Definition in file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a46c408fd0419f6dfd0214a4a6d0f606c" name="a46c408fd0419f6dfd0214a4a6d0f606c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a46c408fd0419f6dfd0214a4a6d0f606c">&#9670;&#160;</a></span>calcape()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calcape </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dpbnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>p1d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>t1d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>q1d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>l1d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>cape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>cins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>pparc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>zeql</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend)&#160;</td>
          <td class="paramname"><em>thund</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calcape() computes CAPE and CINS. </p>
<p>This routine computes CAPE and CINS given temperature, pressure, and specific humidty. In "storm and cloud 
 dynamics" (1989, academic press) cotton and anthes define CAPE (equation 9.16, p501) as</p>
<div class="fragment"><div class="line"><span class="comment">             el</span></div>
<div class="line"><span class="comment"></span>   cape =  sum g * ln(thetap/thetaa) dz </div>
<div class="line">            lcl</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">Where</span>,</div>
<div class="line"> el    = equilibrium level,</div>
<div class="line">lcl    = lifting condenstation level,</div>
<div class="line">  g    = gravitational acceleration,</div>
<div class="line">thetap = lifted parcel potential temperature,</div>
<div class="line">thetaa = ambient potential temperature.</div>
</div><!-- fragment --> <pre class="fragment">Note that the integrand ln(THETAP/THETAA) approximately
equals (THETAP-THETAA)/THETAA.  This ratio is often used
in the definition of CAPE/CINS.

Two types of CAPE/CINS can be computed by this routine.  The
summation process is the same For both cases.  What differs
is the definition of the parcel to lift.  FOR ITYPE=1 the
parcel with the warmest THETA-E in A DPBND pascal layer above
the model surface is lifted.  the arrays P1D, T1D, and Q1D
are not used.  For itype=2 the arrays P1D, T1D, and Q1D
define the parcel to lift in each column.  Both types of
CAPE/CINS may be computed in a single execution of the post
processor.

This algorithm proceeds as follows.
For each column, 
   (1)  Initialize running CAPE and CINS SUM TO 0.0
   (2)  Compute temperature and pressure at the LCL using
        look up table (PTBL).  Use either parcel that gives
        max THETAE in lowest DPBND above ground (ITYPE=1)
        or given parcel from t1D,Q1D,...(ITYPE=2).
   (3)  Compute the temp of a parcel lifted from the LCL.
        We know that the parcel's
        equivalent potential temperature (THESP) remains
        constant through this process.  we can
        compute tpar using this knowledge using look
        up table (subroutine TTBLEX).
   (4)  Find the equilibrium level.  This is defined as the
        highest positively buoyant layer.
        (If there is no positively buoyant layer, CAPE/CINS
         will be zero)
   (5)  Compute CAPE/CINS.  
        (A) Compute THETAP.  We know TPAR and P.
        (B) Compute THETAA.  We know T and P.  
   (6)  Add G*(THETAP-THETAA)*DZ to the running CAPE or CINS sum.
        (A) If THETAP &gt; THETAA, add to the CAPE sum.
        (B) If THETAP &lt; THETAA, add to the CINS sum.
   (7)  Are we at equilibrium level? 
        (A) If yes, stop the summation.
        (b) if no, contiunue the summation.
   (8)  Enforce limits on CAPE and CINS (i.e. no negative CAPE)
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ITYPE</td><td>INTEGER Flag specifying how parcel to lift is identified. See comments above. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DPBND</td><td>Depth over which one searches for most unstable parcel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">P1D</td><td>Array of pressure of parcels to lift. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1D</td><td>Array of temperature of parcels to lift. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Q1D</td><td>Array of specific humidity of parcels to lift. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">L1D</td><td>Array of model level of parcels to lift. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">CAPE</td><td>Convective available potential energy (J/kg). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">CINS</td><td>Convective inhibition (J/kg). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">PPARC</td><td>Pressure level of parcel lifted when one searches over a particular depth to compute CAPE/CIN. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ZEQL</td><td>Equivalent level height. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">THUND</td><td>Thunder parameter.</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md93"></a>
Program history log:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1993-02-10   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1993-06-19   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Generalized routine to allow for type 2 CAPE/CINS calculations    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1994-09-23   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">Modified to use look up tables instead of complicated equations    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1994-10-13   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">Modified to continue CAPE/CINS calc up to at highest buoyant layer    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1998-06-12   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Conversion from 1-D TO 2-D    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1998-08-18   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Compute APE internally    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2000-01-04   </td><td class="markdownTableBodyNone">Jim Tuccillo   </td><td class="markdownTableBodyNone">MPI Version    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2002-01-15   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">WRF Version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2003-08-24   </td><td class="markdownTableBodyNone">G Manikin   </td><td class="markdownTableBodyNone">Added level of parcel being lifted as output from the routine and added the depth over which one searches for the most unstable parcel as input    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2010-09-09   </td><td class="markdownTableBodyNone">G Manikin   </td><td class="markdownTableBodyNone">Changed computation to use virtual temp added eq lvl hght and thunder parameter    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2015-??-??   </td><td class="markdownTableBodyNone">S Moorthi   </td><td class="markdownTableBodyNone">Optimization and threading    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2021-07-28   </td><td class="markdownTableBodyNone">W Meng   </td><td class="markdownTableBodyNone">Restrict computation from undefined grids    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2021-09-01   </td><td class="markdownTableBodyNone">E Colon   </td><td class="markdownTableBodyNone">Equivalent level height index for RTMA   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Russ Treadon W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1993-02-10 </dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l00562">562</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a13b72d00c41c6c1a7dfca7aa9d3266e1" name="a13b72d00c41c6c1a7dfca7aa9d3266e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13b72d00c41c6c1a7dfca7aa9d3266e1">&#9670;&#160;</a></span>calcape2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calcape2 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dpbnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>p1d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>t1d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>q1d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>l1d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>cape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>cins</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>lfc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>esrhl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>esrhh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>dcape</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>dgld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>esp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calcape2() computes CAPE and CINS. </p>
<p>This routine computes CAPE and CINS given temperature, pressure, and specific humidty. In "storm and cloud 
 dynamics" (1989, academic press) cotton and anthes define CAPE (equation 9.16, p501) as</p>
<div class="fragment"><div class="line">             el</div>
<div class="line">   cape =  sum g * ln(thetap/thetaa) dz </div>
<div class="line">            lcl</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">Where</span>,</div>
<div class="line"> el    = equilibrium level,</div>
<div class="line">lcl    = lifting condenstation level,</div>
<div class="line">  g    = gravitational acceleration,</div>
<div class="line">thetap = lifted parcel potential temperature,</div>
<div class="line">thetaa = ambient potential temperature.</div>
</div><!-- fragment --> <pre class="fragment">Note that the integrand ln(THETAP/THETAA) approximately
equals (THETAP-THETAA)/THETAA.  This ratio is often used
in the definition of CAPE/CINS.

Two types of CAPE/CINS can be computed by this routine.  The
summation process is the same For both cases.  What differs
is the definition of the parcel to lift.  FOR ITYPE=1 the
parcel with the warmest THETA-E in A DPBND pascal layer above
the model surface is lifted.  the arrays P1D, T1D, and Q1D
are not used.  For itype=2 the arrays P1D, T1D, and Q1D
define the parcel to lift in each column.  Both types of
CAPE/CINS may be computed in a single execution of the post
processor.

This algorithm proceeds as follows.
For each column, 
   (1)  Initialize running CAPE and CINS SUM TO 0.0
   (2)  Compute temperature and pressure at the LCL using
        look up table (PTBL).  Use either parcel that gives
        max THETAE in lowest DPBND above ground (ITYPE=1)
        or given parcel from t1D,Q1D,...(ITYPE=2).
   (3)  Compute the temp of a parcel lifted from the LCL.
        We know that the parcel's
        equivalent potential temperature (THESP) remains
        constant through this process.  we can
        compute tpar using this knowledge using look
        up table (subroutine TTBLEX).
   (4)  Find the equilibrium level.  This is defined as the
        highest positively buoyant layer.
        (If there is no positively buoyant layer, CAPE/CINS
         will be zero)
   (5)  Compute CAPE/CINS.  
        (A) Compute THETAP.  We know TPAR and P.
        (B) Compute THETAA.  We know T and P.  
   (6)  Add G*(THETAP-THETAA)*DZ to the running CAPE or CINS sum.
        (A) If THETAP &gt; THETAA, add to the CAPE sum.
        (B) If THETAP &lt; THETAA, add to the CINS sum.
   (7)  Are we at equilibrium level? 
        (A) If yes, stop the summation.
        (b) if no, contiunue the summation.
   (8)  Enforce limits on CAPE and CINS (i.e. no negative CAPE)
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ITYPE</td><td>INTEGER Flag specifying how parcel to lift is identified. See comments above. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DPBND</td><td>Depth over which one searches for most unstable parcel. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">P1D</td><td>Array of pressure of parcels to lift. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1D</td><td>Array of temperature of parcels to lift. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Q1D</td><td>Array of specific humidity of parcels to lift. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">L1D</td><td>Array of model level of parcels to lift. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">CAPE</td><td>Convective available potential energy (J/kg). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">CINS</td><td>Convective inhibition (J/kg). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">LFC</td><td>level of free convection (m). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ESRHL</td><td>Lower bound to account for effective helicity calculation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ESRHH</td><td>Upper bound to account for effective helicity calculation. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DCAPE</td><td>downdraft CAPE (J/KG). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DGLD</td><td>Dendritic growth layer depth (m). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ESP</td><td>Enhanced stretching potential.</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md94"></a>
Program history log:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1993-02-10   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1993-06-19   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Generalized routine to allow for type 2 CAPE/CINS calculations    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1994-09-23   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">Modified to use look up tables instead of complicated equations    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1994-10-13   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">Modified to continue CAPE/CINS calc up to at highest buoyant layer    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1998-06-12   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Conversion from 1-D TO 2-D    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1998-08-18   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Compute APE internally    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2000-01-04   </td><td class="markdownTableBodyNone">Jim Tuccillo   </td><td class="markdownTableBodyNone">MPI Version    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2002-01-15   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">WRF Version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2003-08-24   </td><td class="markdownTableBodyNone">G Manikin   </td><td class="markdownTableBodyNone">Added level of parcel being lifted as output from the routine and added the depth over which one searches for the most unstable parcel as input    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2010-09-09   </td><td class="markdownTableBodyNone">G Manikin   </td><td class="markdownTableBodyNone">Changed computation to use virtual temp added eq lvl hght and thunder parameter    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2015-??-??   </td><td class="markdownTableBodyNone">S Moorthi   </td><td class="markdownTableBodyNone">Optimization and threading    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2021-09-03   </td><td class="markdownTableBodyNone">J Meng   </td><td class="markdownTableBodyNone">Modified to add 0-3km CAPE/CINS, LFC, effective helicity, downdraft CAPE, dendritic growth layer depth, ESP    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2021-09-01   </td><td class="markdownTableBodyNone">E Colon   </td><td class="markdownTableBodyNone">Equivalent level height index for RTMA    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2022-08-27   </td><td class="markdownTableBodyNone">S Trahan   </td><td class="markdownTableBodyNone">Fixed bug in CALCAPE2 where extreme atmospheric conditions cause an out-of-bounds access    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2022-09-01   </td><td class="markdownTableBodyNone">S Trahan   </td><td class="markdownTableBodyNone">Fixed another bug in CALCAPE2 where extreme atmospheric conditions cause an out-of-bounds access   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Russ Treadon W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1993-02-10 </dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l01040">1040</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a97b2aa2b11c2ddd32a3999840dbd15ab" name="a97b2aa2b11c2ddd32a3999840dbd15ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97b2aa2b11c2ddd32a3999840dbd15ab">&#9670;&#160;</a></span>caldiv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::caldiv </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u,lm), intent(in)&#160;</td>
          <td class="paramname"><em>uwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u,lm), intent(in)&#160;</td>
          <td class="paramname"><em>vwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,lm), intent(inout)&#160;</td>
          <td class="paramname"><em>div</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CALDIV computes divergence. </p>
<p>For GFS, this routine copmutes the horizontal divergence using 2nd-order centered scheme on a lat-lon grid <br  />
</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">UWND</td><td>U wind (m/s) mass-points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VWND</td><td>V wind (m/s) mass-points. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DIV</td><td>divergence (1/s) mass-points.</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md96"></a>
Program history log:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2016-05-05   </td><td class="markdownTableBodyNone">Sajal Kar   </td><td class="markdownTableBodyNone">Modified CALVORT to compute divergence from wind components    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2016-07-22   </td><td class="markdownTableBodyNone">S Moorthi   </td><td class="markdownTableBodyNone">Modified polar divergence calculation   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Sajal Kar W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2016-05-05 caldiv() computes divergence. </dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l02168">2168</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a671b132cb3bffbe08d56c7b7c2a8ef33" name="a671b132cb3bffbe08d56c7b7c2a8ef33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a671b132cb3bffbe08d56c7b7c2a8ef33">&#9670;&#160;</a></span>calgradps()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calgradps </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u), intent(in)&#160;</td>
          <td class="paramname"><em>ps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u), intent(inout)&#160;</td>
          <td class="paramname"><em>psx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u), intent(inout)&#160;</td>
          <td class="paramname"><em>psy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CALGRADPS computes gardients of a scalar field PS or LNPS. </p>
<p>For GFS, this routine computes horizontal gradients of PS or LNPS. Using 2nd-order centered scheme on a lat-lon grid.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">PS</td><td>Surface pressure (Pa) mass-points. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">PSX</td><td>Zonal gradient of PS at mass-points. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">PSY</td><td>Meridional gradient of PS at mass-points.</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md97"></a>
Program history log:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2016-05-05   </td><td class="markdownTableBodyNone">Sajal Kar   </td><td class="markdownTableBodyNone">Reduced from CALVORT to zonal and meridional gradients of given surface pressure PS, or LNPS   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Sajal Kar W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2016-05-05 </dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l02446">2446</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a6e8141fa69fd4bd9ee1207346f2c69c8" name="a6e8141fa69fd4bd9ee1207346f2c69c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e8141fa69fd4bd9ee1207346f2c69c8">&#9670;&#160;</a></span>calrh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calrh </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(out)&#160;</td>
          <td class="paramname"><em>rh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CALRH() computes relative humidity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P1</td><td>real Pressure (Pa) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1</td><td>real Temperature (K) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Q1</td><td>real Specific humidity (kg/kg) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>P1/T1/Q1 refer to pressure/temperature/specific humidity at the selected /requested level. For example, if the user wants relative humidity at 500mb, then T/P/Q at 500mb is input into the call to output RH@500mb </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">RH</td><td>real Relative humidity (decimal form) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l00072">72</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="adf9004bc64fdc4edc54e3e0e564e60de" name="adf9004bc64fdc4edc54e3e0e564e60de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf9004bc64fdc4edc54e3e0e564e60de">&#9670;&#160;</a></span>calrh_gfs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calrh_gfs </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>rh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calrh_gfs() computes relative humidity. </p>
<p>This routine computes relative humidity given pressure, temperature, specific humidity. an upper and lower bound of 100 and 1 percent relative humidity is enforced. When these bounds are applied the passed specific humidity array is adjusted as necessary to produce the set relative humidity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P1</td><td>Pressure (pa) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1</td><td>Temperature (K) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Q1</td><td>Specific humidity (kg/kg) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">RH</td><td>Relative humidity (decimal form)</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md91"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">????-??-??   </td><td class="markdownTableBodyNone">DENNIS DEAVEN   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1992-12-22   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Modified as described above    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1998-06-08   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Conversion from 1-D to 2-D    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1998-08-18   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">Modify to compute RH over ice as in model    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1998-12-16   </td><td class="markdownTableBodyNone">Geoff Manikin   </td><td class="markdownTableBodyNone">undo RH computation over ice    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2000-01-04   </td><td class="markdownTableBodyNone">Jim Tuccillo   </td><td class="markdownTableBodyNone">MPI Version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2002-06-11   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">WRF Version    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2013-08-13   </td><td class="markdownTableBodyNone">S. Moorthi   </td><td class="markdownTableBodyNone">Threading    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2006-03-19   </td><td class="markdownTableBodyNone">Wen Meng   </td><td class="markdownTableBodyNone">Modify top pressure to 1 pa   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Russ Treadon W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1992-12-22 </dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l00197">197</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a9879351bf693bdbc79b08c01357f5c35" name="a9879351bf693bdbc79b08c01357f5c35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9879351bf693bdbc79b08c01357f5c35">&#9670;&#160;</a></span>calrh_gsd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calrh_gsd </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend)&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend)&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend)&#160;</td>
          <td class="paramname"><em>rhb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CALRH_GSD() Compute RH with the NOAA GSL (formerly NOAA GSD) algorithm used for RUC and Rapid Refresh. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">P1</td><td>real Pressure (Pa) </td></tr>
    <tr><td class="paramname">T1</td><td>real Temperature (K) </td></tr>
    <tr><td class="paramname">Q1</td><td>real Specific humidity (kg/kg) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>P1/T1/Q1 refer to pressure/temperature/specific humidity at the selected /requested level. For example, if the user wants relative humidity at 500mb, then T/P/Q at 500mb is input into the call to output RH@500mb </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">RHB</td><td>real Relative humidity (decimal form) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l00270">270</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a8d369564cb2455aebb6623b64093eaf8" name="a8d369564cb2455aebb6623b64093eaf8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d369564cb2455aebb6623b64093eaf8">&#9670;&#160;</a></span>calrh_nam()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calrh_nam </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>p1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(in)&#160;</td>
          <td class="paramname"><em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(inout)&#160;</td>
          <td class="paramname"><em>q1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend), intent(out)&#160;</td>
          <td class="paramname"><em>rh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calrh_nam() computes relative humidity. </p>
<p>This routine computes relative humidity given pressure, temperature, specific humidity. an upper and lower bound of 100 and 1 percent relative humidity is enforced. When these bounds are applied the passed specific humidity array is adjusted as necessary to produce the set relative humidity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">P1</td><td>Pressure (pa) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">T1</td><td>Temperature (K) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">Q1</td><td>Specific humidity (kg/kg) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">RH</td><td>Relative humidity (decimal form)</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md90"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">????-??-??   </td><td class="markdownTableBodyNone">DENNIS DEAVEN   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1992-12-22   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Modified as described above    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1998-06-08   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Conversion from 1-D to 2-D    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1998-08-18   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">Modify to compute RH over ice as in model    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1998-12-16   </td><td class="markdownTableBodyNone">Geoff Manikin   </td><td class="markdownTableBodyNone">undo RH computation over ice    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2000-01-04   </td><td class="markdownTableBodyNone">Jim Tuccillo   </td><td class="markdownTableBodyNone">MPI Version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2002-06-11   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">WRF Version    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2006-03-19   </td><td class="markdownTableBodyNone">Wen Meng   </td><td class="markdownTableBodyNone">Modify top pressure to 1 pa   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Russ Treadon W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1992-12-22 </dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l00118">118</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="adcd50827e614553e34e5150b7dc2d0d2" name="adcd50827e614553e34e5150b7dc2d0d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adcd50827e614553e34e5150b7dc2d0d2">&#9670;&#160;</a></span>calrh_pw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calrh_pw </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend)&#160;</td>
          <td class="paramname"><em>rhpw</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CALRH_PW() algorithm used at GSL for RUC and Rapid Refresh. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">RHPW</td><td>real Relative humidity with respect to precipitable water (entire atmosphere) </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l00312">312</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a7ed3521072e06748ebed2a1d549cef76" name="a7ed3521072e06748ebed2a1d549cef76"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ed3521072e06748ebed2a1d549cef76">&#9670;&#160;</a></span>calslr_roebber()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calslr_roebber </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u,lsm), intent(in)&#160;</td>
          <td class="paramname"><em>tprs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u,lsm), intent(in)&#160;</td>
          <td class="paramname"><em>rhprs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u), intent(out)&#160;</td>
          <td class="paramname"><em>slr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calslr_roebber() computes snow solid-liquid-ratio slr using the Roebber algorithm. </p>
<p>Obtained the code and data from WPC. WPC's SLR products include SLR computed from GFS and NAM, SLR climotology, and averaged SLR. UPP computes SLR for GFS and RRFS. SLR climatology is not used in UPP calculation but the data is saved in fix directory for reference. Breadboard coefficients are included in this module to enhance the performance. Original Breadboard coefficients files are also saved in fix directory.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">tprs</td><td>real Temperature on pressure levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rhprs</td><td>real Relative humidity on pressure levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">slr</td><td>real Solid snow to liquid ratio.</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md98"></a>
Program history log:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2022-07-11   </td><td class="markdownTableBodyNone">Jesse Meng   </td><td class="markdownTableBodyNone">Initial   </td></tr>
</table>
<p>2023-01-06 | Jesse Meng ! Import Breadboard coefficients into module</p>
<dl class="section author"><dt>Author</dt><dd>Jesse Meng </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2022-07-11 </dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l02681">2681</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a8aeb7fd8cea2061bb31097413ed0a6cf" name="a8aeb7fd8cea2061bb31097413ed0a6cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8aeb7fd8cea2061bb31097413ed0a6cf">&#9670;&#160;</a></span>calslr_uutah()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calslr_uutah </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u), intent(out)&#160;</td>
          <td class="paramname"><em>slr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calslr_uutah() computes snow solid-liquid-ratio slr using the Steenburgh algorithm. </p>
<p>Obtained the code and data from U of Utah Jim Steenburgh and Peter Veals. SLR = m1X1 + m2X2 + m3X3 + m4X4 + m5X5 + m6X6 + b. </p><pre class="fragment"> X1 = wind speed at at 1km above ground level (AGL) in m/s
 m1 = -0.174848

 X2 = temperature at 2km AGL in Kelvin
 m2 = -0.52644

 X3 = wind speed at 2 km AGL in m/s
 m3 = 0.034911

 X4 = wind speed at 500 m AGL in m/s
 m4 = -0.270473

 X5 = temperature at 1 km AGL in Kelvin
 m5 = 0.028299

 X6 = temperature at 500 m AGL in m/s
 m6 = 0.096273

 b =  118.35844
</pre> <dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">SLR</td><td>real Solid snow to liquid ratio</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md99"></a>
Program history log:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2023-01-23   </td><td class="markdownTableBodyNone">Jesse Meng   </td><td class="markdownTableBodyNone">Initial   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Jesse Meng </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2023-01-03 </dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l04350">4350</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a174a9a297a3644adc9f67cd06fa1a208" name="a174a9a297a3644adc9f67cd06fa1a208"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a174a9a297a3644adc9f67cd06fa1a208">&#9670;&#160;</a></span>calvor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public upp_physics::calvor </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u), intent(in)&#160;</td>
          <td class="paramname"><em>uwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u), intent(in)&#160;</td>
          <td class="paramname"><em>vwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u), intent(inout)&#160;</td>
          <td class="paramname"><em>absv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>CALVOR() computes absolute vorticity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">UWND</td><td>U wind (m/s) mass-points. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">VWND</td><td>V wind (m/s) mass-points. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ABSV</td><td>absolute vorticity (1/s) mass-points.</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md95"></a>
Program history log:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1992-12-22   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1998-06-08   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Convesion from 1-D to 2-D    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2000-01-04   </td><td class="markdownTableBodyNone">Jim Tuccillo   </td><td class="markdownTableBodyNone">MPI Version    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2002-01-15   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">WRF Version C-grid    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2005-03-01   </td><td class="markdownTableBodyNone">H Chuang   </td><td class="markdownTableBodyNone">Add NMM E grid    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2005-05-17   </td><td class="markdownTableBodyNone">H Chuang   </td><td class="markdownTableBodyNone">Add Potential vorticity calculation    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2005-07-07   </td><td class="markdownTableBodyNone">B Zhou   </td><td class="markdownTableBodyNone">Add RSM in computing DVDX, DUDY and UAVG    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2013-08-09   </td><td class="markdownTableBodyNone">S Moorthi   </td><td class="markdownTableBodyNone">Optimize the vorticity loop including threading    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2016-08-05   </td><td class="markdownTableBodyNone">S Moorthi   </td><td class="markdownTableBodyNone">add zonal filetering    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2019-10-17   </td><td class="markdownTableBodyNone">Y Mao   </td><td class="markdownTableBodyNone">Skip calculation when U/V is SPVAL    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2020-11-06   </td><td class="markdownTableBodyNone">J Meng   </td><td class="markdownTableBodyNone">Use UPP_MATH Module    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2022-05-26   </td><td class="markdownTableBodyNone">H Chuang   </td><td class="markdownTableBodyNone">Use GSL approach for FV3R   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Russ Treadon W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1992-12-22 </dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l01744">1744</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="aa0e747563558603cdbebb4e81e131e1b" name="aa0e747563558603cdbebb4e81e131e1b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0e747563558603cdbebb4e81e131e1b">&#9670;&#160;</a></span>fpvsnew()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elemental real function, public upp_physics::fpvsnew </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>fpvsnew() computes saturation vapor pressure.</p>
<p>Compute saturation vapor pressure from the temperature. A linear interpolation is done between values in a lookup table computed in gpvs. See documentation for fpvsx for details. Input values outside table range are reset to table extrema. The interpolation accuracy is almost 6 decimal places. On the Cray, fpvs is about 4 times faster than exact calculation. This function should be expanded inline in the calling routine.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Real(krealfp) Temperature in Kelvin. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>fpvsnew Real(krealfp) Saturation vapor pressure in Pascals.</dd></dl>
<h3><a class="anchor" id="autotoc_md92"></a>
Program history log:</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1991-05-07   </td><td class="markdownTableBodyNone">Iredell   </td><td class="markdownTableBodyNone">Initial. Made into inlinable function    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1994-12-30   </td><td class="markdownTableBodyNone">Iredell   </td><td class="markdownTableBodyNone">Expand table    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1999-03-01   </td><td class="markdownTableBodyNone">Iredell   </td><td class="markdownTableBodyNone">F90 module    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2001-02-26   </td><td class="markdownTableBodyNone">Iredell   </td><td class="markdownTableBodyNone">Ice phase   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>N Phillips w/NMC2X2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1982-12-30</dd></dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l00378">378</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
<a id="a70b48ea26577bce987cd88664ce6f10e" name="a70b48ea26577bce987cd88664ce6f10e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70b48ea26577bce987cd88664ce6f10e">&#9670;&#160;</a></span>tvirtual()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">elemental real function, public upp_physics::tvirtual </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>q</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>TVIRTUAL() Computes virtual temperature</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">T</td><td>real Temperature </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">Q</td><td>real Specific humidity </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="UPP__PHYSICS_8f_source.html#l01702">1702</a> of file <a class="el" href="UPP__PHYSICS_8f_source.html">UPP_PHYSICS.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="UPP__PHYSICS_8f.html">UPP_PHYSICS.f</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>

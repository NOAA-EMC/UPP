<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UPP: GFSPOST.F File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">UPP<span id="projectnumber">&#160;(upp-srw-2.2.0)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('GFSPOST_8F.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">GFSPOST.F File Reference</div></div>
</div><!--header-->
<div class="contents">

<p><a class="el" href="GFSPOST_8F.html#a850376cef1f54db803745b71db2e121d" title="pvetc() computes potential vorticity, etc.">pvetc()</a> computes potential vorticity, etc.  
<a href="#details">More...</a></p>

<p><a href="GFSPOST_8F_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ac48b2ca404b07ba2a6d566081445d6da" id="r_ac48b2ca404b07ba2a6d566081445d6da"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GFSPOST_8F.html#ac48b2ca404b07ba2a6d566081445d6da">mptgen</a> (mpirank, mpisize, nd, jt1, jt2, j1, j2, jx, jm, jn)</td></tr>
<tr class="memdesc:ac48b2ca404b07ba2a6d566081445d6da"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="GFSPOST_8F.html#ac48b2ca404b07ba2a6d566081445d6da" title="mptgen() generates grid decomposition dimensions.">mptgen()</a> generates grid decomposition dimensions.  <br /></td></tr>
<tr class="separator:ac48b2ca404b07ba2a6d566081445d6da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17f361c952af5f1d207b1602b33f9ada" id="r_a17f361c952af5f1d207b1602b33f9ada"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GFSPOST_8F.html#a17f361c952af5f1d207b1602b33f9ada">mptranr4</a> (mpicomm, mpisize, im, ida, idb, jm, jma, jmb, jda, km, kma, kmb, kdb, a, b, ta, tb)</td></tr>
<tr class="memdesc:a17f361c952af5f1d207b1602b33f9ada"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="GFSPOST_8F.html#a17f361c952af5f1d207b1602b33f9ada" title="mptranr4() transposes grid decompositions.">mptranr4()</a> transposes grid decompositions.  <br /></td></tr>
<tr class="separator:a17f361c952af5f1d207b1602b33f9ada"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6df28c2d9217d40a82a737889f516dc1" id="r_a6df28c2d9217d40a82a737889f516dc1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GFSPOST_8F.html#a6df28c2d9217d40a82a737889f516dc1">mxwind</a> (km, p, u, v, t, h, pmw, umw, vmw, tmw, hmw)</td></tr>
<tr class="memdesc:a6df28c2d9217d40a82a737889f516dc1"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="GFSPOST_8F.html#a6df28c2d9217d40a82a737889f516dc1" title="mxwind() computes maximum wind level fields.">mxwind()</a> computes maximum wind level fields.  <br /></td></tr>
<tr class="separator:a6df28c2d9217d40a82a737889f516dc1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3b0658596bcad55dfed1cf7561ba6fc" id="r_ac3b0658596bcad55dfed1cf7561ba6fc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GFSPOST_8F.html#ac3b0658596bcad55dfed1cf7561ba6fc">p2pv</a> (km, pvu, h, t, p, u, v, kpv, pv, pvpt, pvpb, lpv, upv, vpv, hpv, tpv, ppv, spv)</td></tr>
<tr class="memdesc:ac3b0658596bcad55dfed1cf7561ba6fc"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="GFSPOST_8F.html#ac3b0658596bcad55dfed1cf7561ba6fc" title="p2pv() interpolates to potential vorticity level.">p2pv()</a> interpolates to potential vorticity level.  <br /></td></tr>
<tr class="separator:ac3b0658596bcad55dfed1cf7561ba6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe55639a0c3bacd6f317eb1112bcc966" id="r_abe55639a0c3bacd6f317eb1112bcc966"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GFSPOST_8F.html#abe55639a0c3bacd6f317eb1112bcc966">p2th</a> (km, theta, u, v, h, t, pvu, sigma, rh, omga, kth, th, lth, uth, vth, hth, tth, zth, sigmath, rhth, oth)</td></tr>
<tr class="memdesc:abe55639a0c3bacd6f317eb1112bcc966"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="GFSPOST_8F.html#abe55639a0c3bacd6f317eb1112bcc966" title="p2th() interpolates from pressure level to isentropic (theta) level.">p2th()</a> interpolates from pressure level to isentropic (theta) level.  <br /></td></tr>
<tr class="separator:abe55639a0c3bacd6f317eb1112bcc966"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a850376cef1f54db803745b71db2e121d" id="r_a850376cef1f54db803745b71db2e121d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GFSPOST_8F.html#a850376cef1f54db803745b71db2e121d">pvetc</a> (km, p, px, py, t, tx, ty, h, u, v, av, hm, s, bvf2, pvn, theta, sigma, pvu)</td></tr>
<tr class="memdesc:a850376cef1f54db803745b71db2e121d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="GFSPOST_8F.html#a850376cef1f54db803745b71db2e121d" title="pvetc() computes potential vorticity, etc.">pvetc()</a> computes potential vorticity, etc.  <br /></td></tr>
<tr class="separator:a850376cef1f54db803745b71db2e121d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dc0227dc28262c865f7966ea3ead79d" id="r_a8dc0227dc28262c865f7966ea3ead79d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GFSPOST_8F.html#a8dc0227dc28262c865f7966ea3ead79d">rsearch1</a> (km1, z1, km2, z2, l2)</td></tr>
<tr class="memdesc:a8dc0227dc28262c865f7966ea3ead79d"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="GFSPOST_8F.html#a8dc0227dc28262c865f7966ea3ead79d" title="rsearch1() searches for a surrounding real interval.">rsearch1()</a> searches for a surrounding real interval.  <br /></td></tr>
<tr class="separator:a8dc0227dc28262c865f7966ea3ead79d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab11ddfd78f47c66c9873fb891762cf31" id="r_ab11ddfd78f47c66c9873fb891762cf31"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="GFSPOST_8F.html#ab11ddfd78f47c66c9873fb891762cf31">tpause</a> (km, p, u, v, t, h, ptp, utp, vtp, ttp, htp, shrtp)</td></tr>
<tr class="memdesc:ab11ddfd78f47c66c9873fb891762cf31"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="GFSPOST_8F.html#ab11ddfd78f47c66c9873fb891762cf31" title="tpause() computes tropopause level fields.">tpause()</a> computes tropopause level fields.  <br /></td></tr>
<tr class="separator:ab11ddfd78f47c66c9873fb891762cf31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p><a class="el" href="GFSPOST_8F.html#a850376cef1f54db803745b71db2e121d" title="pvetc() computes potential vorticity, etc.">pvetc()</a> computes potential vorticity, etc. </p>
<p>This subprogram computes </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">computation   </th><th class="markdownTableHeadNone">equation    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Montgomery streamfunction   </td><td class="markdownTableBodyNone">hm=cp*t+g*z    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Specific entropy   </td><td class="markdownTableBodyNone">s=cp*log(t/t0)-r*log(p/p0)    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Brunt-Vaisala frequency squared   </td><td class="markdownTableBodyNone">bvf2=g/cp*ds/dz    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Potential vorticity   </td><td class="markdownTableBodyNone">pvn=(av*ds/dz-dv/dz*ds/dx+du/dz*ds/dy)/rho/cp    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Potential temperature   </td><td class="markdownTableBodyNone">theta=t0*exp(s/cp)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Static stability   </td><td class="markdownTableBodyNone">sigma=t/g*bvf2    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Potential vorticity in PV units   </td><td class="markdownTableBodyNone">pvu=10**-6*theta*pvn   </td></tr>
</table>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>integer number of levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>real (km) pressure (Pa). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">px</td><td>real (km) pressure x-gradient (Pa/m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">py</td><td>real (km) pressure y-gradient (Pa/m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>real (km) (virtual) temperature (K). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>real (km) (virtual) temperature x-gradient (K/m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>real (km) (virtual) temperature y-gradient (K/m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>real (km) height (m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>real (km) x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>real (km) y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">av</td><td>real (km) absolute vorticity (1/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hm</td><td>real (km) Montgomery streamfunction (m**2/s**2). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">s</td><td>real (km) specific entropy (J/K/kg). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bvf2</td><td>real (km) Brunt-Vaisala frequency squared (1/s**2). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pvn</td><td>real (km) potential vorticity (m**2/kg/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">theta</td><td>real (km) (virtual) potential temperature (K). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sigma</td><td>real (km) static stability (K/m). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pvu</td><td>real (km) potential vorticity (10**-6*K*m**2/kg/s).</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md39"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1999-10-18   </td><td class="markdownTableBodyNone">Mark Iredell   </td><td class="markdownTableBodyNone">Initial   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell np23 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1999-10-18 </dd></dl>

<p class="definition">Definition in file <a class="el" href="GFSPOST_8F_source.html">GFSPOST.F</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ac48b2ca404b07ba2a6d566081445d6da" name="ac48b2ca404b07ba2a6d566081445d6da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac48b2ca404b07ba2a6d566081445d6da">&#9670;&#160;</a></span>mptgen()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mptgen </td>
          <td>(</td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>mpirank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>mpisize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>nd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), dimension(nd), intent(in)&#160;</td>
          <td class="paramname"><em>jt1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), dimension(nd), intent(in)&#160;</td>
          <td class="paramname"><em>jt2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), dimension(nd), intent(out)&#160;</td>
          <td class="paramname"><em>j1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), dimension(nd), intent(out)&#160;</td>
          <td class="paramname"><em>j2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), dimension(nd), intent(out)&#160;</td>
          <td class="paramname"><em>jx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), dimension(nd), intent(out)&#160;</td>
          <td class="paramname"><em>jm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), dimension(nd), intent(out)&#160;</td>
          <td class="paramname"><em>jn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="GFSPOST_8F.html#ac48b2ca404b07ba2a6d566081445d6da" title="mptgen() generates grid decomposition dimensions.">mptgen()</a> generates grid decomposition dimensions. </p>
<p>This subprogram decomposes total dimensions of a problem into smaller domains to be managed on a distributed memory system. The last dimension given is decomposed first. If more decompositions are possible, the next to last dimension is decomposed next, and so on. The transpositions between decompositions should be done by mptran*.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mpirank</td><td>integer(kint_mpi) rank of the process (from mpi_comm_rank). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpisize</td><td>integer(kint_mpi) size of the process (from mpi_comm_size). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nd</td><td>integer(kint_mpi) number of dimensions to decompose. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jt1</td><td>integer(kint_mpi) (nd) lower bounds of total dimensions. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jt2</td><td>integer(kint_mpi) (nd) upper bounds of total dimensions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">j1</td><td>integer(kint_mpi) (nd) lower bounds of local decompositions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">j2</td><td>integer(kint_mpi) (nd) upper bounds of local decompositions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jx</td><td>integer(kint_mpi) (nd) local size of decompositions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jm</td><td>integer(kint_mpi) (nd) maximum size of decompositions. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">jn</td><td>integer(kint_mpi) (nd) number of decompositions.</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md45"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1999-02-12   </td><td class="markdownTableBodyNone">Mark Iredell   </td><td class="markdownTableBodyNone">Initial   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell np23 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1999-02-12 <br  />
 </dd></dl>

<p class="definition">Definition at line <a class="el" href="GFSPOST_8F_source.html#l00547">547</a> of file <a class="el" href="GFSPOST_8F_source.html">GFSPOST.F</a>.</p>

</div>
</div>
<a id="a17f361c952af5f1d207b1602b33f9ada" name="a17f361c952af5f1d207b1602b33f9ada"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17f361c952af5f1d207b1602b33f9ada">&#9670;&#160;</a></span>mptranr4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mptranr4 </td>
          <td>(</td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>mpicomm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>mpisize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>im</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>ida</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>idb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jmb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>jda</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>kma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>kmb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer(kint_mpi), intent(in)&#160;</td>
          <td class="paramname"><em>kdb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(4), dimension(ida,jda,kma), intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(4), dimension(idb,kdb,jmb), intent(out)&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(4), dimension(im,jm,km,mpisize), intent(inout)&#160;</td>
          <td class="paramname"><em>ta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(4), dimension(im,jm,km,mpisize), intent(inout)&#160;</td>
          <td class="paramname"><em>tb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="GFSPOST_8F.html#a17f361c952af5f1d207b1602b33f9ada" title="mptranr4() transposes grid decompositions.">mptranr4()</a> transposes grid decompositions. </p>
<p>This subprogram transposes an array of data from one grid decomposition to another by using message passing. The grid decompositions should be generated by mptgen.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">mpicomm</td><td>integer(kint_mpi) mpi communicator. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">mpisize</td><td>integer(kint_mpi) size of the process (from mpi_comm_size). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">im</td><td>integer(kint_mpi) undecomposed range. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ida</td><td>integer(kint_mpi) undecomposed input dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idb</td><td>integer(kint_mpi) undecomposed output dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jm</td><td>integer(kint_mpi) output grid decomposition size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jma</td><td>integer(kint_mpi) input grid undecomposed range. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jmb</td><td>integer(kint_mpi) output grid decomposed range. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jda</td><td>integer(kint_mpi) input grid undecomposed dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>integer(kint_mpi) input grid decomposition size. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kma</td><td>integer(kint_mpi) input grid decomposed range. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kmb</td><td>integer(kint_mpi) output grid undecomposed range. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kdb</td><td>integer(kint_mpi) output grid undecomposed dimension. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>real(4) (ida,jda,kma) input array. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">b</td><td>real(4) (idb,kdb,jmb) output array. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ta,tb</td><td>real(4) (im,jm,km,mpisize) work arrays.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>While this routine serves a wide variety of scalable transpose functions for multidimensional grids,<ul>
<li>It does not work with nonrectanguloid grids;</li>
<li>It does not do any load balancing;</li>
<li><p class="startli">It does not do any communication hiding.</p>
<p class="startli">This subprogram must be used rather than mpi_alltoall in any of the following cases:</p>
</li>
<li>The undecomposed range is less than the respective dimension (either im&lt;ida or im&lt;idb)</li>
<li>The decomposition size is greater than one (either km&gt;1 or jm&gt;1)</li>
<li>The decomposed range is ever zero (either kma==0 or jmb==0 for any process)</li>
<li><p class="startli">The output grid range is not the full extent (either kmb&lt;mpisize or kmb&lt;kda or jma&lt;mpisize or jma&lt;jda)</p>
<p class="startli">If none of these conditions apply, mpi_alltoall could be used directly rather than this subprogram and would be more efficient. </p>
</li>
</ul>
</dd>
<dd>
Example 1. Transpose a 1000 x 10000 matrix. <pre>
  include 'mpif.h'                                     ! use mpi
  parameter(jt=1000,kt=10000)                          ! set problem size
  real,allocatable:: a(:,:),b(:,:)                     ! declare arrays
  call mpi_init(ierr)                                  ! initialize mpi
  call mpi_comm_rank(MPI_COMM_WORLD,mpirank,ierr)      ! get mpi rank
  call mpi_comm_size(MPI_COMM_WORLD,mpisize,ierr)      ! get mpi size
  call mptgen(mpirank,mpisize,1,1,jt,j1,j2,jx,jm,jn)   ! decompose output
  call mptgen(mpirank,mpisize,1,1,kt,k1,k2,kx,km,kn)   ! decompose input
  allocate(a(jt,k1:k2),b(kt,j1:j2))                    ! allocate arrays
  a=reshape((/((j+k,j=1,jt),k=k1,k2)/),(/jt,k2-k1+1/)) ! initialize input
  call mptranr4(MPI_COMM_WORLD,mpisize,1,1,1,          ! transpose arrays
  &amp;              jm,jt,j2-j1+1,jt,km,k2-k1+1,kt,kt,a,b)
  print '(2i8,f16.1)',((k,j,b(k,j),k=2000,kt,2000),    ! print some values
  &amp;                    j=((j1-1)/200+1)*200,j2,200)
  call mpi_finalize(ierr)                              ! finalize mpi
  end
 </pre> This transpose took 0.6 seconds on 4 2-way winterhawk nodes. </dd>
<dd>
A 20000x10000 transpose took 3.4 seconds on 16 2-way winterhawk nodes. </dd>
<dd>
Thus a transpose may take about 1 second for every 16 Mb per node.</dd></dl>
<h3><a class="anchor" id="autotoc_md46"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1999-02-12   </td><td class="markdownTableBodyNone">Mark Iredell   </td><td class="markdownTableBodyNone">Initial   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell np23 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1999-02-12 </dd></dl>

<p class="definition">Definition at line <a class="el" href="GFSPOST_8F_source.html#l00649">649</a> of file <a class="el" href="GFSPOST_8F_source.html">GFSPOST.F</a>.</p>

</div>
</div>
<a id="a6df28c2d9217d40a82a737889f516dc1" name="a6df28c2d9217d40a82a737889f516dc1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6df28c2d9217d40a82a737889f516dc1">&#9670;&#160;</a></span>mxwind()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine mxwind </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>pmw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>umw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>vmw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>tmw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>hmw</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="GFSPOST_8F.html#a6df28c2d9217d40a82a737889f516dc1" title="mxwind() computes maximum wind level fields.">mxwind()</a> computes maximum wind level fields. </p>
<p>This subprogram finds the maximum wind level and computes fields at the maximum wind level. The maximum wind level is searched for between 500 mb and 100 mb. The height and wind speed at the maximum wind speed level is calculated by assuming the wind speed varies quadratically in height in the neighborhood of the maximum wind level. The other fields are interpolated linearly in height to the maximum wind level. The maximum wind level pressure is found hydrostatically.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>integer number of levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>real (km) pressure (Pa). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>real (km) x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>real (km) y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>real (km) temperature (K). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>real (km) height (m). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pmw</td><td>real maximum wind level pressure (Pa). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">umw</td><td>real maximum wind level x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vmw</td><td>real maximum wind level y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tmw</td><td>maximum wind level temperature (K). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hmw</td><td>real maximum wind level height (m).</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md44"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1999-10-18   </td><td class="markdownTableBodyNone">Mark Iredell   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2005-02-02   </td><td class="markdownTableBodyNone">Mark Iredell   </td><td class="markdownTableBodyNone">Changed upper limit to 100 mb   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell np23 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1999-10-18 </dd></dl>

<p class="definition">Definition at line <a class="el" href="GFSPOST_8F_source.html#l00459">459</a> of file <a class="el" href="GFSPOST_8F_source.html">GFSPOST.F</a>.</p>

<p class="reference">References <a class="el" href="GFSPOST_8F_source.html#l00298">rsearch1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MISCLN_8f_source.html#l00058">miscln()</a>.</p>

</div>
</div>
<a id="ac3b0658596bcad55dfed1cf7561ba6fc" name="ac3b0658596bcad55dfed1cf7561ba6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3b0658596bcad55dfed1cf7561ba6fc">&#9670;&#160;</a></span>p2pv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine p2pv </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>pvu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kpv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kpv), intent(in)&#160;</td>
          <td class="paramname"><em>pv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kpv), intent(in)&#160;</td>
          <td class="paramname"><em>pvpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kpv), intent(in)&#160;</td>
          <td class="paramname"><em>pvpb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical*1, dimension(kpv), intent(out)&#160;</td>
          <td class="paramname"><em>lpv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kpv), intent(out)&#160;</td>
          <td class="paramname"><em>upv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kpv), intent(out)&#160;</td>
          <td class="paramname"><em>vpv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kpv), intent(out)&#160;</td>
          <td class="paramname"><em>hpv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kpv), intent(out)&#160;</td>
          <td class="paramname"><em>tpv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kpv), intent(out)&#160;</td>
          <td class="paramname"><em>ppv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kpv), intent(out)&#160;</td>
          <td class="paramname"><em>spv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="GFSPOST_8F.html#ac3b0658596bcad55dfed1cf7561ba6fc" title="p2pv() interpolates to potential vorticity level.">p2pv()</a> interpolates to potential vorticity level. </p>
<p>This subprogram interpolates fields to given potential vorticity levels within given pressure limits. The output level is the first encountered from the top pressure limit. If the given potential vorticity level is not found, the outputs are zero and the bitmap is false. The interpolation is linear in potential vorticity.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>integer number of levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pvu</td><td>real (km) potential vorticity in PV units (10**-6*K*m**2/kg/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>real (km) height (m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>real (km) temperature (K). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>real (km) pressure (Pa). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>real (km) x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>real (km) y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kpv</td><td>integer number of potential vorticity levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pv</td><td>real (kpv) potential vorticity levels (10**-6*K*m**2/kg/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pvpt</td><td>real (kpv) top pressures for PV search (Pa). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pvpb</td><td>real (kpv) bottom pressures for PV search (Pa). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">lpv</td><td>logical*1 (kpv) bitmap. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">upv</td><td>real (kpv) x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vpv</td><td>real (kpv) y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hpv</td><td>real (kpv) temperature (K). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tpv</td><td>real (kpv) temperature (K). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ppv</td><td>real (kpv) pressure (Pa). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">spv</td><td>real (kpv) wind speed shear (1/s).</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md41"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1999-10-18   </td><td class="markdownTableBodyNone">Mark Iredell   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2021-08-31   </td><td class="markdownTableBodyNone">Hui-ya Chuang   </td><td class="markdownTableBodyNone">Increase depth criteria for identifying PV layer from 25 to 50 to avoid finding shallow high level PV layer in high latitudes   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell np23 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1999-10-18 </dd></dl>

<p class="definition">Definition at line <a class="el" href="GFSPOST_8F_source.html#l00203">203</a> of file <a class="el" href="GFSPOST_8F_source.html">GFSPOST.F</a>.</p>

<p class="reference">References <a class="el" href="GFSPOST_8F_source.html#l00298">rsearch1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MDL2THANDPV_8f_source.html#l00031">mdl2thandpv()</a>.</p>

</div>
</div>
<a id="abe55639a0c3bacd6f317eb1112bcc966" name="abe55639a0c3bacd6f317eb1112bcc966"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe55639a0c3bacd6f317eb1112bcc966">&#9670;&#160;</a></span>p2th()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine p2th </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>pvu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>rh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>omga</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>kth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kth), intent(in)&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical*1, dimension(kth), intent(out)&#160;</td>
          <td class="paramname"><em>lth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kth), intent(out)&#160;</td>
          <td class="paramname"><em>uth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kth), intent(out)&#160;</td>
          <td class="paramname"><em>vth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kth), intent(out)&#160;</td>
          <td class="paramname"><em>hth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kth), intent(out)&#160;</td>
          <td class="paramname"><em>tth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kth), intent(out)&#160;</td>
          <td class="paramname"><em>zth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kth), intent(out)&#160;</td>
          <td class="paramname"><em>sigmath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kth), intent(out)&#160;</td>
          <td class="paramname"><em>rhth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(kth), intent(out)&#160;</td>
          <td class="paramname"><em>oth</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="GFSPOST_8F.html#abe55639a0c3bacd6f317eb1112bcc966" title="p2th() interpolates from pressure level to isentropic (theta) level.">p2th()</a> interpolates from pressure level to isentropic (theta) level. </p>
<p>This subprogram interpolates fields to given isentropic levels. The interpolation is linear in entropy. Outside the domain the bitmap is set to false.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>integer number of levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theta</td><td>real (km) potential temperature (K). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>real (km) x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>real (km) y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>real (km) height (m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>real (km) temperature (K). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pvu</td><td>real (km) potential vorticity in PV units (10**-6*K*m**2/kg/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigma</td><td>real (km) static stability (K/m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">rh</td><td>real (km) relative humidity. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">omga</td><td>real (km) vertical velocity in pressure coordinates (Pa/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kth</td><td>integer number of isentropic levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">th</td><td>real (kth) isentropic levels (K). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lth</td><td>logical*1 (kth) bitmap. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">uth</td><td>real (kth) x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vth</td><td>real (kth) y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hth</td><td>real (kth) height (m). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">tth</td><td>real (kth) temperature (K). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">zth</td><td>real (kth) potential vorticity in PV units (10**-6*K*m**2/kg/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sigmath</td><td>(kth) real static stability (K/m). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">rhth</td><td>(kth) real relative humidity. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">oth</td><td>(kth) real vertical velocity in pressure coordinates (Pa/s).</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md40"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1999-10-18   </td><td class="markdownTableBodyNone">Mark Iredell   </td><td class="markdownTableBodyNone">Initial   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell np23 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1999-10-18 </dd></dl>

<p class="definition">Definition at line <a class="el" href="GFSPOST_8F_source.html#l00137">137</a> of file <a class="el" href="GFSPOST_8F_source.html">GFSPOST.F</a>.</p>

<p class="reference">References <a class="el" href="GFSPOST_8F_source.html#l00298">rsearch1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MDL2THANDPV_8f_source.html#l00031">mdl2thandpv()</a>.</p>

</div>
</div>
<a id="a850376cef1f54db803745b71db2e121d" name="a850376cef1f54db803745b71db2e121d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a850376cef1f54db803745b71db2e121d">&#9670;&#160;</a></span>pvetc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine pvetc </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>px</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>py</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>ty</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>av</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(out)&#160;</td>
          <td class="paramname"><em>hm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(out)&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(out)&#160;</td>
          <td class="paramname"><em>bvf2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(out)&#160;</td>
          <td class="paramname"><em>pvn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(out)&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(out)&#160;</td>
          <td class="paramname"><em>sigma</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(out)&#160;</td>
          <td class="paramname"><em>pvu</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="GFSPOST_8F.html#a850376cef1f54db803745b71db2e121d" title="pvetc() computes potential vorticity, etc.">pvetc()</a> computes potential vorticity, etc. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>integer number of levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>real (km) pressure (Pa). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">px</td><td>real (km) pressure x-gradient (Pa/m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">py</td><td>real (km) pressure y-gradient (Pa/m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>real (km) (virtual) temperature (K). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>real (km) (virtual) temperature x-gradient (K/m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ty</td><td>real (km) (virtual) temperature y-gradient (K/m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>real (km) height (m). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>real (km) x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>real (km) y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">av</td><td>real (km) absolute vorticity (1/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hm</td><td>real (km) Montgomery streamfunction (m**2/s**2). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">s</td><td>real (km) specific entropy (J/K/kg). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bvf2</td><td>real (km) Brunt-Vaisala frequency squared (1/s**2). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pvn</td><td>real (km) potential vorticity (m**2/kg/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">theta</td><td>real (km) (virtual) potential temperature (K). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sigma</td><td>real (km) static stability (K/m). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pvu</td><td>real (km) potential vorticity (10**-6*K*m**2/kg/s). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="GFSPOST_8F_source.html#l00062">62</a> of file <a class="el" href="GFSPOST_8F_source.html">GFSPOST.F</a>.</p>

<p class="reference">References <a class="el" href="GFSPOST_8F_source.html#l00298">rsearch1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MDL2THANDPV_8f_source.html#l00031">mdl2thandpv()</a>.</p>

</div>
</div>
<a id="a8dc0227dc28262c865f7966ea3ead79d" name="a8dc0227dc28262c865f7966ea3ead79d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dc0227dc28262c865f7966ea3ead79d">&#9670;&#160;</a></span>rsearch1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine rsearch1 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km1), intent(in)&#160;</td>
          <td class="paramname"><em>z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km2), intent(in)&#160;</td>
          <td class="paramname"><em>z2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(km2), intent(out)&#160;</td>
          <td class="paramname"><em>l2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="GFSPOST_8F.html#a8dc0227dc28262c865f7966ea3ead79d" title="rsearch1() searches for a surrounding real interval.">rsearch1()</a> searches for a surrounding real interval. </p>
<p>This subprogram searches a monotonic sequences of real numbers for intervals that surround a given search set of real numbers. the sequences may be monotonic in either direction; the real numbers may be single or double precision.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km1</td><td>integer number of points in the sequence. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z1</td><td>real (km1) sequence values to search. (z1 must be monotonic in either direction) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">km2</td><td>integer number of points to search for. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">z2</td><td>real (km2) set of values to search for. (z2 need not be monotonic) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">l2</td><td>integer (km2) interval locations from 0 to km1. (z2 will be between z1(l2) and z1(l2+1))</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd><ul>
<li>Returned values of 0 or km1 indicate that the given search value is outside the range of the sequence.</li>
<li>If a search value is identical to one of the sequence values then the location returned points to the identical value.</li>
<li>If the sequence is not strictly monotonic and a search value is identical to more than one of the sequence values, then the location returned may point to any of the identical values.</li>
<li>If l2(k)=0, then z2(k) is less than the start point z1(1) for ascending sequences (or greater than for descending sequences).</li>
<li>If l2(k)=km1, then z2(k) is greater than or equal to the end point z1(km1) for ascending sequences (or less than or equal to for descending sequences). Otherwise z2(k) is between the values z1(l2(k)) and z1(l2(k+1)) and may equal the former.</li>
</ul>
</dd></dl>
<h3><a class="anchor" id="autotoc_md42"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1998-05-01   </td><td class="markdownTableBodyNone">Mark Iredell   </td><td class="markdownTableBodyNone">Initial   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell w/nmc23 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1998-05-01 </dd></dl>

<p class="definition">Definition at line <a class="el" href="GFSPOST_8F_source.html#l00297">297</a> of file <a class="el" href="GFSPOST_8F_source.html">GFSPOST.F</a>.</p>

<p class="reference">Referenced by <a class="el" href="GFSPOST_8F_source.html#l00460">mxwind()</a>, <a class="el" href="GFSPOST_8F_source.html#l00205">p2pv()</a>, <a class="el" href="GFSPOST_8F_source.html#l00139">p2th()</a>, <a class="el" href="GFSPOST_8F_source.html#l00063">pvetc()</a>, and <a class="el" href="GFSPOST_8F_source.html#l00373">tpause()</a>.</p>

</div>
</div>
<a id="ab11ddfd78f47c66c9873fb891762cf31" name="ab11ddfd78f47c66c9873fb891762cf31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab11ddfd78f47c66c9873fb891762cf31">&#9670;&#160;</a></span>tpause()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine tpause </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>km</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(km), intent(in)&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>ptp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>utp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>vtp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>ttp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>htp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>shrtp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="GFSPOST_8F.html#ab11ddfd78f47c66c9873fb891762cf31" title="tpause() computes tropopause level fields.">tpause()</a> computes tropopause level fields. </p>
<p>This subprogram finds the tropopause level and computes fields at the tropopause level. The tropopause is defined as the lowest level above 500 mb which has a temperature lapse rate of less than 2 K/km. The lapse rate must average less than 2 K/km over a 2 km depth. If no such level is found below 50 mb, the tropopause is set to 50 mb. The tropopause fields are interpolated linearly in lapse rate. The tropopause pressure is found hydrostatically. The tropopause wind shear is computed as the partial derivative of wind speed with respect to height at the tropopause level.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">km</td><td>integer number of levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">p</td><td>real (km) pressure (Pa). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">u</td><td>real (km) x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">v</td><td>real (km) y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>real (km) temperature (K). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">h</td><td>real (km) height (m). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ptp</td><td>real tropopause pressure (Pa). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">utp</td><td>real tropopause x-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">vtp</td><td>real tropopause y-component wind (m/s). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ttp</td><td>real tropopause temperature (K). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">htp</td><td>real tropopause height (m). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">shrtp</td><td>real tropopause wind shear (1/s).</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md43"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1999-10-18   </td><td class="markdownTableBodyNone">Mark Iredell   </td><td class="markdownTableBodyNone">Initial   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Mark Iredell np23 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1999-10-18 </dd></dl>

<p class="definition">Definition at line <a class="el" href="GFSPOST_8F_source.html#l00372">372</a> of file <a class="el" href="GFSPOST_8F_source.html">GFSPOST.F</a>.</p>

<p class="reference">References <a class="el" href="GFSPOST_8F_source.html#l00298">rsearch1()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MISCLN_8f_source.html#l00058">miscln()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="GFSPOST_8F.html">GFSPOST.F</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>

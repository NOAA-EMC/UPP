<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>UPP: FDLVL.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">UPP<span id="projectnumber">&#160;(develop)</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('FDLVL_8f.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">FDLVL.f File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Subroutine that computes T, Q, U, V, P, and ICING on the flight levels (FD).  
<a href="#details">More...</a></p>

<p><a href="FDLVL_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:acf00630f37f7e3e7e9e894eec6526d47" id="r_acf00630f37f7e3e7e9e894eec6526d47"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="FDLVL_8f.html#acf00630f37f7e3e7e9e894eec6526d47">fdlvl</a> (itype, tfd, qfd, ufd, vfd, pfd, icingfd)</td></tr>
<tr class="memdesc:acf00630f37f7e3e7e9e894eec6526d47"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="FDLVL_8f.html#acf00630f37f7e3e7e9e894eec6526d47" title="fdlvl() Subroutine that computes T, Q, U, V, P, ICING on the flight levels (FD).">fdlvl()</a> Subroutine that computes T, Q, U, V, P, ICING on the flight levels (FD).  <br /></td></tr>
<tr class="separator:acf00630f37f7e3e7e9e894eec6526d47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af26c00e6ed22206112653ed791f72c5d" id="r_af26c00e6ed22206112653ed791f72c5d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="FDLVL_8f.html#af26c00e6ed22206112653ed791f72c5d">fdlvl_mass</a> (itype, nfd, ptfd, htfd, nin, qin, qtype, qfd)</td></tr>
<tr class="memdesc:af26c00e6ed22206112653ed791f72c5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes FD level for mass variables.  <br /></td></tr>
<tr class="separator:af26c00e6ed22206112653ed791f72c5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af119d1f5e9957290885276cae217b8eb" id="r_af119d1f5e9957290885276cae217b8eb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="FDLVL_8f.html#af119d1f5e9957290885276cae217b8eb">fdlvl_uv</a> (itype, nfd, htfd, ufd, vfd)</td></tr>
<tr class="memdesc:af119d1f5e9957290885276cae217b8eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes FD level for u,v.  <br /></td></tr>
<tr class="separator:af119d1f5e9957290885276cae217b8eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Subroutine that computes T, Q, U, V, P, and ICING on the flight levels (FD). </p>
<p>This routine computes temperature, spec. hum, u wind component, and v wind component on the NFD=6 FD levels. The height of these levels (in meters) is given in the data statement below. The alogrithm proceeds as follows. (AGL-Above ground level in parentheses)</p>
<p>At each mass point move up vertically from the LM-TH (lowest atmospheric) ETA layer. Find the ETA layers whose <br  />
 height (above ground) bounds the target FD level height. Vertically interpolate to get temperature at this FD level. Average the four surrounding winds to get a mass point wind. Vertically interpolate these mass point winds to the target FD level. Continue this process until all NFD=6 FD levels have been processed. Move on to the next mass point. <br  />
</p>
<p>Averaging the four above ground winds to the mass point was found to smooth the field and reduce the occurrence of point peak winds far in excess of the winds at adjacent points. Mass point values are returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ITYPE</td><td>Flag that determines whether MSL (1) or AGL (2) Levels are used. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TFD</td><td>Temperature (K) on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">QFD</td><td>Spec hum on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">UFD</td><td>U wind (m/s) on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">VFD</td><td>V wind (m/s) on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">PFD</td><td>Pressure (Pa) on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ICINGFD</td><td>Icing on FD levels (see <a href="https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table4-207.shtml">https://www.nco.ncep.noaa.gov/pmb/docs/grib2/grib2_doc/grib2_table4-207.shtml</a>).</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md39"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1992-12-22   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1993-11-23   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Corrected routine to compute FD levels with respect to mean sea level    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1994-01-04   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">Include options for computing either AGL or MSL    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1998-06-15   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Conversion from 1-D to 2-D    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2000-01-04   </td><td class="markdownTableBodyNone">Jim Tuccillo   </td><td class="markdownTableBodyNone">MPI version    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2002-01-15   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">WRF version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2011-12-14   </td><td class="markdownTableBodyNone">Sarah Lu   </td><td class="markdownTableBodyNone">Add GOCART aerosol AERFD    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2021-10-15   </td><td class="markdownTableBodyNone">JESSE MENG   </td><td class="markdownTableBodyNone">2D DECOMPOSITION    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2022-09-22   </td><td class="markdownTableBodyNone">Li(Kate) Zhang   </td><td class="markdownTableBodyNone">Remove Dust=&gt; AERFD   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Russ Treadon W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1992-12-22 </dd></dl>

<p class="definition">Definition in file <a class="el" href="FDLVL_8f_source.html">FDLVL.f</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="acf00630f37f7e3e7e9e894eec6526d47" name="acf00630f37f7e3e7e9e894eec6526d47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf00630f37f7e3e7e9e894eec6526d47">&#9670;&#160;</a></span>fdlvl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fdlvl </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(nfd), intent(in)&#160;</td>
          <td class="paramname"><em>itype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>tfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>qfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>ufd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>vfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>pfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>icingfd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="FDLVL_8f.html#acf00630f37f7e3e7e9e894eec6526d47" title="fdlvl() Subroutine that computes T, Q, U, V, P, ICING on the flight levels (FD).">fdlvl()</a> Subroutine that computes T, Q, U, V, P, ICING on the flight levels (FD). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ITYPE</td><td>Flag that determines whether MSL (1) or AGL (2) Levels are used. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">TFD</td><td>Temperature (K) on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">QFD</td><td>Spec hum on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">UFD</td><td>U wind (m/s) on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">VFD</td><td>V wind (m/s) on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">PFD</td><td>Pressure (Pa) on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ICINGFD</td><td>Icing on FD levels. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="FDLVL_8f_source.html#l00059">59</a> of file <a class="el" href="FDLVL_8f_source.html">FDLVL.f</a>.</p>

<p class="reference">References <a class="el" href="EXCH_8f_source.html#l00027">exch()</a>.</p>

<p class="reference">Referenced by <a class="el" href="MISCLN_8f_source.html#l00058">miscln()</a>.</p>

</div>
</div>
<a id="af26c00e6ed22206112653ed791f72c5d" name="af26c00e6ed22206112653ed791f72c5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af26c00e6ed22206112653ed791f72c5d">&#9670;&#160;</a></span>fdlvl_mass()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fdlvl_mass </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(nfd), intent(in)&#160;</td>
          <td class="paramname"><em>itype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nfd), intent(in)&#160;</td>
          <td class="paramname"><em>ptfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nfd), intent(in)&#160;</td>
          <td class="paramname"><em>htfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,lm,nin), intent(in)&#160;</td>
          <td class="paramname"><em>qin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character, dimension(nin), intent(in)&#160;</td>
          <td class="paramname"><em>qtype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd,nin), intent(out)&#160;</td>
          <td class="paramname"><em>qfd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes FD level for mass variables. </p>
<p>This routine computes mass variables (temperature, spec. hum...) on NFD FD levels. The height of these levels (in meters) is passed as an input parameter. The alogrithm proceeds as follows. (AGL-Above ground level in parentheses)</p>
<p>At each mass point move up vertically from the LM-TH (lowest atmospheric) ETA layer. Find the ETA layers whose <br  />
 height (above ground) bounds the target FD level height. Vertically interpolate to get temperature at this FD level. Average the four surrounding winds to get a mass point wind. Vertically interpolate these mass point winds to the target FD level. Continue this process until all NFD FD levels have been processed. Move on to the next mass point.</p>
<p>Averaging the four above ground winds to the mass point was found to smooth the field and reduce the occurrence of point peak winds far in excess of the winds at adjacent points. Mass point values are returned.</p>
<p>NOTES for Q fields by Y Mao: The following safety check should be executed by the caller of FDLVL subroutines. Safety check to avoid tiny QFD values. KRF: Need NCAR and NMM WRF cores in this check as well? </p><div class="fragment"><div class="line"><span class="keywordflow">IF</span>(modelname==<span class="stringliteral">&#39;RAPR&#39;</span> .OR. modelname==<span class="stringliteral">&#39;NCAR&#39;</span> .OR. modelname==<span class="stringliteral">&#39;NMM&#39;</span>) <span class="keywordflow">THEN</span>   <span class="comment">!</span></div>
<div class="line">  <span class="keywordflow">DO</span> ifd = 1,nfd</div>
<div class="line">    <span class="keywordflow">DO</span> j=jsta,jend</div>
<div class="line">    <span class="keywordflow">DO</span> i=1,im</div>
<div class="line">       <span class="keywordflow">if</span>(qfd(i,j,ifd) &lt; 1.0e-8) qfd(i,j,ifd)=0.0</div>
<div class="line"><span class="keywordflow">    ENDDO</span></div>
<div class="line"><span class="keywordflow">    ENDDO</span></div>
<div class="line"><span class="keywordflow">  ENDDO</span></div>
<div class="line">endif</div>
</div><!-- fragment --><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ITYPE</td><td>Flag that determines whether MSL (1) or AGL (2) Levels are used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NFD</td><td>Number of FD levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">PTFD</td><td>FD pressure levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HTFD</td><td>FD height levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NIN</td><td>Number of input fields. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">QIN</td><td>Array of mass point value on model levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">QTYPE</td><td>Charater array of variable type to differentiate underground interpolation. <pre>
                   C-5 Cloud Species
                   K-TURBULENT KINETIC ENERGY
                   Q-Specific Humidity
                   T-Temperature, 
                   W-Vertical Velocity or Omega
</pre> </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">QFD</td><td>Array of mass point value on FD levels.</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md41"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1992-12-22   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1993-11-23   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Corrected routine to compute FD levels with respect to mean sea level    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1994-01-04   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">Include options for computing either AGL or MSL    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1998-06-15   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Conversion from 1-D to 2-D    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2000-01-04   </td><td class="markdownTableBodyNone">Jim Tuccillo   </td><td class="markdownTableBodyNone">MPI version    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2002-01-15   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">WRF version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2011-12-14   </td><td class="markdownTableBodyNone">Sarah Lu   </td><td class="markdownTableBodyNone">Add GOCART aerosol AERFD    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2017-06-01   </td><td class="markdownTableBodyNone">Y Mao   </td><td class="markdownTableBodyNone">Add FD levels for GTG(EDPARM CATEDR MWTURB) and allow levels input from control file    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2019-09-25   </td><td class="markdownTableBodyNone">Y Mao   </td><td class="markdownTableBodyNone">Seperate mass from UV allow array of mass input to interpolate multiple fields with the same levels at one time. Dust=&gt; AERFD can be processed when NIN=NBIN_DU    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2020-11-10   </td><td class="markdownTableBodyNone">Jesse Meng   </td><td class="markdownTableBodyNone">Use UPP_PHYSICS module    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2022-05-25   </td><td class="markdownTableBodyNone">Y Mao   </td><td class="markdownTableBodyNone">Remove interpolation of w/omega/Hydrometeor fields on FD levels   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Russ Treadon W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1992-12-22 </dd></dl>

<p class="definition">Definition at line <a class="el" href="FDLVL_8f_source.html#l00798">798</a> of file <a class="el" href="FDLVL_8f_source.html">FDLVL.f</a>.</p>

<p class="reference">Referenced by <a class="el" href="MISCLN_8f_source.html#l00058">miscln()</a>.</p>

</div>
</div>
<a id="af119d1f5e9957290885276cae217b8eb" name="af119d1f5e9957290885276cae217b8eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af119d1f5e9957290885276cae217b8eb">&#9670;&#160;</a></span>fdlvl_uv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine fdlvl_uv </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(nfd), intent(in)&#160;</td>
          <td class="paramname"><em>itype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nfd), intent(in)&#160;</td>
          <td class="paramname"><em>htfd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>ufd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista_2l:iend_2u,jsta_2l:jend_2u,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>vfd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes FD level for u,v. </p>
<p>This routine computes u/v wind component on NFD FD levels. The height of these levels (in meters) is passed as an input parameter. The alogrithm proceeds as follows. (AGL-Above ground level in parentheses)</p>
<p>At each mass point move up vertically from the LM-TH (lowest atmospheric) ETA layer. Find the ETA layers whose <br  />
 height (above ground) bounds the target FD level height. Vertically interpolate to get temperature at this FD level. Average the four surrounding winds to get a mass point wind. Vertically interpolate these mass point winds to the target FD level. Continue this process until all NFD FD levels have been processed. Move on to the next mass point. <br  />
</p>
<p>Averaging the four above ground winds to the mass point was found to smooth the field and reduce the occurrence of point peak winds far in excess of the winds at adjacent points. Mass point values are returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ITYPE</td><td>Flag that determines whether MSL (1) or AGL (2) Levels are used. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">NFD</td><td>Number of FD levels. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HTFD</td><td>FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">UFD</td><td>U wind (m/s) on FD levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">VFD</td><td>V wind (m/s) on FD levels.</td></tr>
  </table>
  </dd>
</dl>
<h3><a class="anchor" id="autotoc_md40"></a>
Program History Log</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Date   </th><th class="markdownTableHeadNone">Programmer   </th><th class="markdownTableHeadNone">Comments    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1992-12-22   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Initial    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1993-11-23   </td><td class="markdownTableBodyNone">Russ Treadon   </td><td class="markdownTableBodyNone">Corrected routine to compute FD levels with respect to mean sea level    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">1994-01-04   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">Include options for computing either AGL or MSL    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1998-06-15   </td><td class="markdownTableBodyNone">T Black   </td><td class="markdownTableBodyNone">Conversion from 1-D to 2-D    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2000-01-04   </td><td class="markdownTableBodyNone">Jim Tuccillo   </td><td class="markdownTableBodyNone">MPI version    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2002-01-15   </td><td class="markdownTableBodyNone">Mike Baldwin   </td><td class="markdownTableBodyNone">WRF version    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2011-12-14   </td><td class="markdownTableBodyNone">Sarah Lu   </td><td class="markdownTableBodyNone">Add GOCART aerosol AERFD    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2019-09-25   </td><td class="markdownTableBodyNone">Y Mao   </td><td class="markdownTableBodyNone">Seperate U/V from mass   </td></tr>
</table>
<dl class="section author"><dt>Author</dt><dd>Russ Treadon W/NP2 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>1992-12-22 </dd></dl>

<p class="definition">Definition at line <a class="el" href="FDLVL_8f_source.html#l00467">467</a> of file <a class="el" href="FDLVL_8f_source.html">FDLVL.f</a>.</p>

<p class="reference">References <a class="el" href="EXCH_8f_source.html#l00027">exch()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="FDLVL_8f.html">FDLVL.f</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
